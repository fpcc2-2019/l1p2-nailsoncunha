---
title: "EDA buscas"
output: html_notebook
---

O objeto principal da análise são as buscas e a navegação depois da busca. Criamos esses dados a partir dos dados originais da wikimedia em `/data/search_data.csv`. 

Aqui, exploramos esses dados. 

```{r setup}
library(tidyverse)
library(here)
library(lubridate)
theme_set(theme_bw())
```

```{r ETL}
buscas = read_csv(here::here("data/search_data.csv"))
```
```{r}
glimpse(buscas)
```

```{r}
buscas %>% 
    ggplot(aes(x = results)) + 
    geom_histogram(binwidth = 5) 
```
```{r}
buscas %>% 
    ggplot(aes(x = session_start_date, y = results)) +
    geom_point(alpha = .5)
```

```{r}
zeros = buscas %>% select(results, group, session_start_date) %>% mutate(day_date = date(session_start_date))

zeros_per_week =  zeros %>%  group_by(day_date, group) %>% 
    summarise(zeros_results_day = sum(results == 0), total_results = n()) %>%  mutate(proportion = (zeros_results_day/total_results) * 100)

glimpse(zeros_per_week)
```

```{r}
zeros_per_week %>% distinct(day_date)
```

```{r}
zeros_per_week %>%  
    ggplot(aes(x = day_date, y = proportion, color = group)) + 
    geom_point() + geom_line() + scale_x_date() + labs (
        x = "Dia",
        y = "Zero resultados / Total de resultados"
    )
```

